name: VISION CI/CD Pipeline

# 当推送到 main 分支时触发
on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:

  # 任务: 网页文件完整性检查
  check-web-integrity:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    
    # 1. 检查核心首页
    - name: Verify Index Page
      run: |
        if [ -f "index.html" ]; then
          echo "✅ index.html found. (首页存在)"
        else
          echo "❌ Error: index.html is missing!"
          exit 1
        fi

    # 2. 检查 TV 版 (如果没上传也不报错，只是警告)
    - name: Verify TV Page
      run: |
        if [ -f "tv.html" ]; then
          echo "✅ tv.html found. (TV版存在)"
        else
          echo "⚠️ Warning: tv.html is missing. (TV版未上传)"
        fi

    # 3. 检查文档
    - name: Verify Documentation
      run: |
        if [ -f "README.md" ]; then
          echo "✅ README.md found."
        else
          echo "⚠️ Warning: README.md is missing."
        fi

  # 任务: 简单的 HTML 语法检查 (可选，不通过也不卡流程)
  html-syntax-check:
    runs-on: ubuntu-latest
    needs: check-web-integrity
    steps:
    - uses: actions/checkout@v3
    - name: Simple Syntax Check
      run: |
        grep -q "<!DOCTYPE html>" index.html && echo "✅ Doctype looks good." || echo "⚠️ Check Doctype."


